<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>XenServer, SSDs & VM Storage Performance - smcleod.net</title><meta name=Description content><meta property="og:title" content="XenServer, SSDs & VM Storage Performance"><meta property="og:description" content="IntroAt Infoxchange we use XenServer as our Virtualisation of choice. There are many reasons for this including:
Open Source. Offers greater performance than VMware. Affordability (it&rsquo;s free unless you purchase support). Proven backend Xen is very reliable. Reliable cross-host migrations of VMs. The XenCentre client, (although having to run in a Windows VM) is quick and simple to use. Upgrades and patches have proven to be more reliable than VMware. OpenStack while interesting, is not yet reliable or streamlined enough for our small team of 4 to implement and manage. XenServer Storage & Filesystems Unfortunately the downside to XenServer is that it&rsquo;s underlying OS is quite old."><meta property="og:type" content="article"><meta property="og:url" content="https://beta.smcleod.net/2015/02/xenserver-ssds-vm-storage-performance/"><meta property="og:image" content="https://beta.smcleod.net/apple-touch-icon.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-02-15T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-31T15:04:28+11:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://beta.smcleod.net/apple-touch-icon.png"><meta name=twitter:title content="XenServer, SSDs & VM Storage Performance"><meta name=twitter:description content="IntroAt Infoxchange we use XenServer as our Virtualisation of choice. There are many reasons for this including:
Open Source. Offers greater performance than VMware. Affordability (it&rsquo;s free unless you purchase support). Proven backend Xen is very reliable. Reliable cross-host migrations of VMs. The XenCentre client, (although having to run in a Windows VM) is quick and simple to use. Upgrades and patches have proven to be more reliable than VMware. OpenStack while interesting, is not yet reliable or streamlined enough for our small team of 4 to implement and manage. XenServer Storage & Filesystems Unfortunately the downside to XenServer is that it&rsquo;s underlying OS is quite old."><meta name=application-name content="smcleod.net"><meta name=apple-mobile-web-app-title content="smcleod.net"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=../../../logo.svg><link rel=apple-touch-icon sizes=180x180 href=../../../apple-touch-icon.png><link rel=mask-icon href=../../../safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://beta.smcleod.net/2015/02/xenserver-ssds-vm-storage-performance/><link rel=prev href=https://beta.smcleod.net/2010/06/bmw-e36-328i-manual-conversion-programming/><link rel=next href=https://beta.smcleod.net/2015/02/the-best-of-2014-edition/><link rel=stylesheet href=../../../lib/normalize/normalize.min.8235a67a2521ef99fb1e455a5891b022af1653b4ede3cfffcac4e473beee88fbcc1a36bbb3cfdd75fd6df46732032f9d96e30adae9c88b769e1fbf7945cd27e0.css integrity="sha512-gjWmeiUh75n7HkVaWJGwIq8WU7Tt48//ysTkc77uiPvMGja7s8/ddf1t9GcyAy+dluMK2unIi3aeH795Rc0n4A=="><link rel=stylesheet href=../../../css/style.min.18108d84e024a889c14d785ff688fe13b654fa9bdc1118490c01fd2d42d6d7ae133fc32040282141aa703a4581fc715573ddde9fdb5f6520fbace1c06f846cd0.css integrity="sha512-GBCNhOAkqInBTXhf9oj+E7ZU+pvcERhJDAH9LULW164TP8MgQCghQapwOkWB/HFVc93en9tfZSD7rOHAb4Rs0A=="><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=../../../lib/fontawesome-free/all.min.eb8387c9eb0ab6d4fa4d7ad397d15df13b92c009a1eb221b757dd1ecfccabc78a4c5b681847a7f4198ff7cd60abed8300508c9dea138cd1f4a85f09f09b2092a.css integrity="sha512-64OHyesKttT6TXrTl9Fd8TuSwAmh6yIbdX3R7PzKvHikxbaBhHp/QZj/fNYKvtgwBQjJ3qE4zR9KhfCfCbIJKg=="><noscript><link rel=stylesheet href=../../../lib/fontawesome-free/all.min.eb8387c9eb0ab6d4fa4d7ad397d15df13b92c009a1eb221b757dd1ecfccabc78a4c5b681847a7f4198ff7cd60abed8300508c9dea138cd1f4a85f09f09b2092a.css integrity="sha512-64OHyesKttT6TXrTl9Fd8TuSwAmh6yIbdX3R7PzKvHikxbaBhHp/QZj/fNYKvtgwBQjJ3qE4zR9KhfCfCbIJKg=="></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=../../../lib/animate/animate.min.738daa4d2c3fc0f677ff92c1cc3f81c397fb6d2176a31a2eeb011bf88fe5a9e68a57914321f32fbd1a7bef6cb88dc24b2ae1943a96c931d83f053979d1f25803.css integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw=="><noscript><link rel=stylesheet href=../../../lib/animate/animate.min.738daa4d2c3fc0f677ff92c1cc3f81c397fb6d2176a31a2eeb011bf88fe5a9e68a57914321f32fbd1a7bef6cb88dc24b2ae1943a96c931d83f053979d1f25803.css integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw=="></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"XenServer, SSDs \u0026 VM Storage Performance","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/beta.smcleod.net\/2015\/02\/xenserver-ssds-vm-storage-performance\/"},"image":["https:\/\/beta.smcleod.net\/apple-touch-icon.png"],"genre":"posts","keywords":"tech, storage, hardware, xen","wordcount":966,"url":"https:\/\/beta.smcleod.net\/2015\/02\/xenserver-ssds-vm-storage-performance\/","datePublished":"2015-02-15T00:00:00+00:00","dateModified":"2022-10-31T15:04:28+11:00","license":"Sam McLeod","publisher":{"@type":"Organization","name":"Sam McLeod"},"author":{"@type":"Person","name":"Sam McLeod"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark")}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=../../../ title=smcleod.net><img class="lazyload logo" data-src=../../../logo.svg data-srcset="../../../logo.svg, ../../../logo.svg 1.5x, ../../../logo.svg 2x" data-sizes=auto alt=/logo.svg title=/logo.svg>smcleod.net</a></div><div class=menu><div class=menu-inner><a class=menu-item href=../../../posts/>📝 Posts </a><a class=menu-item href=../../../categories/>🍱 Categories </a><a class=menu-item href=../../../series/>📚 Series </a><a class=menu-item href=../../../links/ title="Links to software and services I use">🔗 Links </a><a class=menu-item href=../../../about/ title="Sam McLeod">🤦🏻‍♂️ About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=# onclick=return!1 class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=../../../ title=smcleod.net><img class="lazyload logo" data-src=../../../logo.svg data-srcset="../../../logo.svg, ../../../logo.svg 1.5x, ../../../logo.svg 2x" data-sizes=auto alt=/logo.svg title=/logo.svg>smcleod.net</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=# onclick=return!1 class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=../../../posts/ title>📝 Posts</a><a class=menu-item href=../../../categories/ title>🍱 Categories</a><a class=menu-item href=../../../series/ title>📚 Series</a><a class=menu-item href=../../../links/ title="Links to software and services I use">🔗 Links</a><a class=menu-item href=../../../about/ title="Sam McLeod">🤦🏻‍♂️ About</a><a href=# onclick=return!1 class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#direct-disk-access>Direct disk access</a></li><li><a href=#performance-benchmarks>Performance (benchmarks)</a><ul><li><a href=#observations>Observations</a></li></ul></li><li><a href=#hardware>Hardware</a></li><li><a href=#xenservers-future>XenServer&rsquo;s Future</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">XenServer, SSDs & VM Storage Performance</h1><div class=post-meta><div class=post-meta-line><span class=post-author><i class="author fas fa-user-circle fa-fw"></i><a href=https://github.com/sammcj title=Author target=_blank rel="noopener noreferrer author" class=author>Sam McLeod</a>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>category <a href=../../../categories/tech/><i class="far fa-folder fa-fw"></i>Tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2015-02-15>2015-02-15</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2022-10-31>2022-10-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;966 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#direct-disk-access>Direct disk access</a></li><li><a href=#performance-benchmarks>Performance (benchmarks)</a><ul><li><a href=#observations>Observations</a></li></ul></li><li><a href=#hardware>Hardware</a></li><li><a href=#xenservers-future>XenServer&rsquo;s Future</a></li></ul></nav></div></div><div class=content id=content><h2 id=intro class=headerLink><a href=#intro class=header-mark></a>Intro</h2><p>At Infoxchange we use XenServer as our Virtualisation of choice.
There are many reasons for this including:</p><ul><li>Open Source.</li><li>Offers greater performance than VMware.</li><li>Affordability (it&rsquo;s free unless you purchase support).</li><li>Proven backend Xen is very reliable.</li><li>Reliable cross-host migrations of VMs.</li><li>The XenCentre client, (although having to run in a Windows VM) is quick and simple to use.</li><li>Upgrades and patches have proven to be more reliable than VMware.</li><li>OpenStack while interesting, is not yet reliable or streamlined enough for our small team of 4 to implement and manage.</li><li>XenServer Storage & Filesystems</li></ul><p>Unfortunately the downside to XenServer is that it&rsquo;s underlying OS is quite old.
The latest version (6.5) about to be released is still based on Centos 5 and still lacks any form of EXT4 and BTRFS support, direct disk access is not available… without some tweaking and has no real support for TRIM unless you have direct disk access and are happy with EXT3.</p><p>Despite this, XenServer still manages to easily outperform VMware in both storage and CPU performance while costing… nothing unless you purchase support!</p><h2 id=direct-disk-access class=headerLink><a href=#direct-disk-access class=header-mark></a>Direct disk access</h2><p>It turns out, that you can add custom udev rules to pass through devices directly to VMs.</p><p>For example, assuming <code>/dev/sdb</code> is the disk you wish to make available to guests, you can edit <code>/etc/udev/rules.d/50-udev.rules</code> like so:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>ACTION</span><span class=o>==</span><span class=s2>&#34;add&#34;</span>, <span class=nv>KERNEL</span><span class=o>==</span><span class=s2>&#34;sdb&#34;</span>, <span class=nv>SYMLINK</span><span class=o>+=</span><span class=s2>&#34;xapi/block/%k&#34;</span>, <span class=nv>RUN</span><span class=o>+=</span><span class=s2>&#34;/bin/sh -c &#39;/opt/xensource/libexec/local-device-change %k 2&gt;&amp;1 &gt;/dev/null&amp;&#39;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>ACTION</span><span class=o>==</span><span class=s2>&#34;remove&#34;</span>, <span class=nv>KERNEL</span><span class=o>==</span><span class=s2>&#34;sdb&#34;</span>, <span class=nv>RUN</span><span class=o>+=</span><span class=s2>&#34;/bin/sh -c &#39;/opt/xensource/libexec/local-device-change %k 2&gt;&amp;1 &gt;/dev/null&amp;&#39;&#34;</span>
</span></span></code></pre></div><p>There are some limitations with this:</p><p>You&rsquo;re passing through the whole disk and can only grant that entire disk to a single VM.
The udev configuration is volitile and is likely to be lost upon installing XenServer updates.
You cannot (to my knowledge) boot from directly attached storage devices.
What I&rsquo;ve actually done is partitioned the SSD RAID array into 4 paritions on the XenServer host, this allows me to carve up the SSD RAID array and present adiquit storage to several VMs on the host.
i.e.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>ACTION</span><span class=o>==</span><span class=s2>&#34;add&#34;</span>, <span class=nv>KERNEL</span><span class=o>==</span><span class=s2>&#34;sdb1&#34;</span>, <span class=nv>SYMLINK</span><span class=o>+=</span><span class=s2>&#34;xapi/block/%k&#34;</span>, <span class=nv>RUN</span><span class=o>+=</span><span class=s2>&#34;/bin/sh -c &#39;/opt/xensource/libexec/local-device-change %k 2&gt;&amp;1 &gt;/dev/null&amp;&#39;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>ACTION</span><span class=o>==</span><span class=s2>&#34;remove&#34;</span>, <span class=nv>KERNEL</span><span class=o>==</span><span class=s2>&#34;sdb1&#34;</span>, <span class=nv>RUN</span><span class=o>+=</span><span class=s2>&#34;/bin/sh -c &#39;/opt/xensource/libexec/local-device-change %k 2&gt;&amp;1 &gt;/dev/null&amp;&#39;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>ACTION</span><span class=o>==</span><span class=s2>&#34;add&#34;</span>, <span class=nv>KERNEL</span><span class=o>==</span><span class=s2>&#34;sdb2&#34;</span>, <span class=nv>SYMLINK</span><span class=o>+=</span><span class=s2>&#34;xapi/block/%k&#34;</span>, <span class=nv>RUN</span><span class=o>+=</span><span class=s2>&#34;/bin/sh -c &#39;/opt/xensource/libexec/local-device-change %k 2&gt;&amp;1 &gt;/dev/null&amp;&#39;&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>ACTION</span><span class=o>==</span><span class=s2>&#34;remove&#34;</span>, <span class=nv>KERNEL</span><span class=o>==</span><span class=s2>&#34;sdb2&#34;</span>, <span class=nv>RUN</span><span class=o>+=</span><span class=s2>&#34;/bin/sh -c &#39;/opt/xensource/libexec/local-device-change %k 2&gt;&amp;1 &gt;/dev/null&amp;&#39;&#34;</span>
</span></span></code></pre></div><p>etc…</p><p>I&rsquo;ve then:</p><ul><li>Mapped each partition to a VM running on that host.</li><li>Partitioned it within the host as needed.</li><li>Mounted /var/lib/docker as a BTRFS volume with compression enabled (compress=lzo) - This is used by CI as we build our our applications in Docker.</li><li>Mounted /home as an EXT4 - This is used by Gitlab-CI to checkout the pre-reqs for each build.</li></ul><h2 id=performance-benchmarks class=headerLink><a href=#performance-benchmarks class=header-mark></a>Performance (benchmarks)</h2><h3 id=observations class=headerLink><a href=#observations class=header-mark></a>Observations</h3><p>The HP P410i RAID card on the old G6 DL360&rsquo;s I am using for this is far underpowered and is unable to perform anywhere near the SSD&rsquo;s rated speeds.
Direct disk access is 2-6 times ‘faster&rsquo; than XenServer&rsquo;s standard LVM or EXT3 storage.
There is less than a 10% difference in performance between the SSD RAID array on the VM with the presented disk than directly on the XenServer host.
XenServer&rsquo;s raw disk performance was exactly the same as Debian 7.
Remember to ensure your RAID (and disk cache if not in prod) is enabled!
Points of Note:</p><p>This is an old server, we&rsquo;re not talking your latest and greatest hardware here, we&rsquo;re talking giving new life to an old-ish dog so that it may retain its usefulness while remaining cost effective.
With TRIM being unavailable when using RAID, it is expected that the write performance will decrease somewhat overtime as the disks fill up as the disks will have to perform a ‘READ, ERASE, WRITE&rsquo; rather than a simple WRITE, To aid the lack of TRIM, I have left more than 25% of the disks unused as we simply don&rsquo;t need 1TB of SSD storage on each of the hosts.
We have some 1GB cache cards arriving in the following weeks which we will upgrade to from the 512MB cards presently installed - I expect this to significantly further improve performance.</p><h2 id=hardware class=headerLink><a href=#hardware class=header-mark></a>Hardware</h2><ul><li>Refurbished HP DL360 G6 (2010 model).</li><li>2x 8 Core Xeon x5550 w/ hyperthreading, 8 cores presented to domU.</li><li>96GB DDR3 in dom0, 4GB in domU.</li><li>HP P410i w/ 512MB cache.</li><li>2x 10K 146GB spindles for dom0.</li><li>‘HP Genuine'!</li><li>Constant 5-6 Watts each + cooling.</li><li>2x SanDisk Extreme Pro SSD 480GB in RAID 0</li><li>SATA III, Read up to 550MB/s, Write up to 515MB/s, Random Read up to 100K IOPS, Random Write up to 90K IOPS.</li><li>0.15-0.2 Watts peak each.</li></ul><p>EXT4 Bonnie++ Results w/ 2x SSD in RAID1, XenServer 6.5 RC1, LVM:</p><p><a class=lightgallery href=https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg title=https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg data-thumbnail=https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg><img class=lazyload data-src=https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg data-srcset="https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg, https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg 1.5x, https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg 2x" data-sizes=auto alt=https://beta.smcleod.net//img/xenserver/dl360-lvm.jpg></a></p><p>EXT4 Bonnie++ Results w/ 2x SSD in RAID1, XenServer 6.5 RC1, Direct Disk:</p><p><a class=lightgallery href=https://beta.smcleod.net//img/xenserver/dl360-dd.jpg title=https://beta.smcleod.net//img/xenserver/dl360-dd.jpg data-thumbnail=https://beta.smcleod.net//img/xenserver/dl360-dd.jpg><img class=lazyload data-src=https://beta.smcleod.net//img/xenserver/dl360-dd.jpg data-srcset="https://beta.smcleod.net//img/xenserver/dl360-dd.jpg, https://beta.smcleod.net//img/xenserver/dl360-dd.jpg 1.5x, https://beta.smcleod.net//img/xenserver/dl360-dd.jpg 2x" data-sizes=auto alt=https://beta.smcleod.net//img/xenserver/dl360-dd.jpg></a></p><p>EXT4 dd Results w/ 2x SSD in RAID0, XenServer 6.5 RC1, LVM:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>samm@serv-dhcp-13:/var/tmp# dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span>tempfile <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>count</span><span class=o>=</span><span class=m>8000</span> <span class=nv>conv</span><span class=o>=</span>fdatasync,notrunc
</span></span><span class=line><span class=cl> 8000+0 records in
</span></span><span class=line><span class=cl> 8000+0 records out
</span></span><span class=line><span class=cl> <span class=m>8388608000</span> bytes <span class=o>(</span>8.4 GB<span class=o>)</span> copied, 118.11 s, 71.0 MB/s
</span></span></code></pre></div><p>EXT4 dd Results w/ 2x SSD in RAID0, XenServer 6.5 RC1, Direct Disk:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>samm@serv-dhcp-13:/var/tmp# dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span>tempfile <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>count</span><span class=o>=</span><span class=m>8000</span> <span class=nv>conv</span><span class=o>=</span>fdatasync,notrunc
</span></span><span class=line><span class=cl> 8000+0 records in
</span></span><span class=line><span class=cl> 8000+0 records out
</span></span><span class=line><span class=cl> <span class=m>8388608000</span> bytes <span class=o>(</span>8.4 GB<span class=o>)</span> copied, 19.21 s, <span class=m>437</span> MB/s
</span></span></code></pre></div><p>Future Benchmarking Steps</p><ul><li>Observe performance over time since TRIM is not available.</li><li>Upgrade RAID cards to 1GB cache (we have some spares).</li><li>Try with our new Gen8 BL460c blade servers, with locally attached P420i RAID controllers and 2GB cache.</li><li>Try linux software RAID with direct disks.</li></ul><h2 id=xenservers-future class=headerLink><a href=#xenservers-future class=header-mark></a>XenServer&rsquo;s Future</h2><p>Filesystems</p><p>I would hope that both EXT4 (and BTRFS) support is added in the near future.
With this I would expect auto-detecting TRIM support similar to VMware and Hyper-V.
Direct Disk Access</p><p>Direct disk access clearly offers massive performance gains, I would like to see XenServer add this as an easy to use option when configuring storage.</p><p>Non-volatile advanced configuration</p><p>Related to direct disk access, XenServer needs some form of non-volatile advanced configuration options.
VMware, raw Xen and KVM let you tweak many options without risk of loss after installing minor updates.</p></div><h2>Related Content</h2><div class=related-container><div class=related-item-container><div class=related-image><a href=../../../2022/10/making-work-visible-avoid-dms/><img class=lazyload data-src=../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg data-srcset="../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg, ../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg 1.5x, ../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg 2x" data-sizes=auto alt=/2022/10/making-work-visible-avoid-dms/dm-disruption.jpg title=/2022/10/making-work-visible-avoid-dms/dm-disruption.jpg height=200 width=400></a></div><h2 class=related-title><a href=../../../2022/10/making-work-visible-avoid-dms/>Making Work Visible - Avoid DMs</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../2021/07/rancilio-silvia-upgrade/><img class=lazyload data-src=../../../2021/07/rancilio-silvia-upgrade/assembled_preview.jpeg data-srcset="../../../2021/07/rancilio-silvia-upgrade/assembled_preview.jpeg, ../../../2021/07/rancilio-silvia-upgrade/assembled_preview.jpeg 1.5x, ../../../2021/07/rancilio-silvia-upgrade/assembled_preview.jpeg 2x" data-sizes=auto alt=/2021/07/rancilio-silvia-upgrade/assembled_preview.jpeg title=/2021/07/rancilio-silvia-upgrade/assembled_preview.jpeg height=200 width=400></a></div><h2 class=related-title><a href=../../../2021/07/rancilio-silvia-upgrade/>Rancilio Silvia Upgrade</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../2019/08/camels-dressed-as-unicorns/><img class=lazyload data-src=../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg data-srcset="../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg, ../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg 1.5x, ../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg 2x" data-sizes=auto alt=/2019/08/camels-dressed-as-unicorns/camel_corn.jpeg title=/2019/08/camels-dressed-as-unicorns/camel_corn.jpeg height=200 width=400></a></div><h2 class=related-title><a href=../../../2019/08/camels-dressed-as-unicorns/>Camels Dressed As Unicorns</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../2019/08/looking-for-new-opportunities/><img class=lazyload data-src=../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg data-srcset="../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg, ../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg 1.5x, ../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg 2x" data-sizes=auto alt=/2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg title=/2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg height=200 width=400></a></div><h2 class=related-title><a href=../../../2019/08/looking-for-new-opportunities/>Looking For New Opportunities</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../2019/06/leaving-infoxchange/><img class=lazyload data-src=../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg data-srcset="../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg, ../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg 1.5x, ../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg 2x" data-sizes=auto alt=/2019/06/leaving-infoxchange/road-no-car-2048.jpg title=/2019/06/leaving-infoxchange/road-no-car-2048.jpg height=200 width=400></a></div><h2 class=related-title><a href=../../../2019/06/leaving-infoxchange/>Leaving Infoxchange</a></h2></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-10-31&nbsp;<a class=git-hash href=https://github.com/sammcj/smcleod-hugo/commit/28c2c547888f2ba4282f805d20e3bc774697430d target=_blank title="commit by Sam McLeod(sammcj@users.noreply.github.com) 28c2c547888f2ba4282f805d20e3bc774697430d: A new start" rel="noopener noreferrer">
<i class="fas fa-hashtag fa-fw"></i>28c2c54</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-mardown href=../../../2015/02/xenserver-ssds-vm-storage-performance/index.md target=_blank rel="noopener noreferrer">Read markdown</a>
</span><span>|&nbsp;<a class=link-to-edit href=https://github.com/sammcj/smcleod-hugo/edit/main/content/posts/2015-02-15-xenserver-ssds--vm-storage-performance/index.md target=_blank rel="noopener noreferrer">Edit this page</a></span></div><div class=post-info-share><span><a href=# onclick=return!1 title="Share on Twitter" data-sharer=twitter data-url=https://beta.smcleod.net/2015/02/xenserver-ssds-vm-storage-performance/ data-title="XenServer, SSDs & VM Storage Performance" data-via=s_mcleod data-hashtags=tech,storage,hardware,xen><i class="fab fa-twitter fa-fw"></i></a><a href=# onclick=return!1 title="Share on Linkedin" data-sharer=linkedin data-url=https://beta.smcleod.net/2015/02/xenserver-ssds-vm-storage-performance/><i class="fab fa-linkedin fa-fw"></i></a><a href=# onclick=return!1 title="Share on Hacker News" data-sharer=hackernews data-url=https://beta.smcleod.net/2015/02/xenserver-ssds-vm-storage-performance/ data-title="XenServer, SSDs & VM Storage Performance"><i class="fab fa-hacker-news fa-fw"></i></a><a href=# onclick=return!1 title="Share on Reddit" data-sharer=reddit data-url=https://beta.smcleod.net/2015/02/xenserver-ssds-vm-storage-performance/><i class="fab fa-reddit fa-fw"></i></a><a href=# onclick=return!1 title="Share on Pocket" data-sharer=pocket data-url=https://beta.smcleod.net/2015/02/xenserver-ssds-vm-storage-performance/><i class="fab fa-get-pocket fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=../../../tags/tech/>tech</a>,&nbsp;<a href=../../../tags/storage/>storage</a>,&nbsp;<a href=../../../tags/hardware/>hardware</a>,&nbsp;<a href=../../../tags/xen/>xen</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=../../../>Home</a></span></section></div><div class=post-nav><a href=../../../2010/06/bmw-e36-328i-manual-conversion-programming/ class=prev rel=prev title="BMW E36 328i Manual Conversion Programming"><i class="fas fa-angle-left fa-fw"></i>BMW E36 328i Manual Conversion Programming</a>
<a href=../../../2015/02/the-best-of-2014-edition/ class=next rel=next title="The Best Of - 2014 Edition">The Best Of - 2014 Edition<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2010 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/sammcj target=_blank rel="noopener noreferrer">Sam McLeod</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=../../../atkinson-hyperlegible/atkinson-hyperlegible.eab28ad9966784d2ce9271970fa9cde34de4a323c0e4cd22fb5ffbf5261b049f52e236f1c06684c0ba73f72454f180c6e9e4667bee6cec7e9d5ac2d9dcb7b24e.css integrity="sha512-6rKK2ZZnhNLOknGXD6nN403koyPA5M0i+1/79SYbBJ9S4jbxwGaEwLpz9yRU8YDG6eRme+5s7H6dWsLZ3LeyTg=="><noscript><link rel=stylesheet href=../../../atkinson-hyperlegible/atkinson-hyperlegible.eab28ad9966784d2ce9271970fa9cde34de4a323c0e4cd22fb5ffbf5261b049f52e236f1c06684c0ba73f72454f180c6e9e4667bee6cec7e9d5ac2d9dcb7b24e.css integrity="sha512-6rKK2ZZnhNLOknGXD6nN403koyPA5M0i+1/79SYbBJ9S4jbxwGaEwLpz9yRU8YDG6eRme+5s7H6dWsLZ3LeyTg=="></noscript><script type=text/javascript src=../../../lib/autocomplete/autocomplete.min.0dcc8ee301dccbd9fb18115a1176e1293ca233b99aee5f5d12f218463c34eccea29f842827fc1ce330cf26e1e21b1382725ad3d0703cbde9f7e28552bcd92c07.js integrity="sha512-DcyO4wHcy9n7GBFaEXbhKTyiM7ma7l9dEvIYRjw07M6in4QoJ/wc4zDPJuHiGxOCclrT0HA8ven34oVSvNksBw=="></script><script type=text/javascript src=../../../lib/fuse/fuse.min.3dd1499ec34f39e57a4363bb184754a5023e0f9c47115d67dbec47058d78fb562f0c929c84d44a0a1ca7f84ed73b907e40fa84995338a66677721853139fb70f.js integrity="sha512-PdFJnsNPOeV6Q2O7GEdUpQI+D5xHEV1n2+xHBY14+1YvDJKchNRKChyn+E7XO5B+QPqEmVM4pmZ3chhTE5+3Dw=="></script><script type=text/javascript src=../../../lib/lazysizes/lazysizes.min.ab9f37a692ab09173b3793b49f69f352227eb2e52fec4b752467a5b386d739a30541c6a63e4f478dd5249d9bae16304db3bb6c32e69d81ee64f51cdd98efb519.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ=="></script><script type=text/javascript src=../../../lib/topbar/topbar.min.db5613fde0d014e29123106077225a764bdb4bdf791c2d252c1db5c09f19ea0bd181d29e10a1c03fddc6b0666d83ed17645ee84c31fb405fc7c0b8b38fd95eb0.js integrity="sha512-21YT/eDQFOKRIxBgdyJadkvbS995HC0lLB21wJ8Z6gvRgdKeEKHAP93GsGZtg+0XZF7oTDH7QF/HwLizj9lesA=="></script><script type=text/javascript src=../../../lib/pjax/pjax.min.8f92ba6fd6079d25aa09e1be3b1e3568438eba0fa53a093eb559684245a9c227d65e346122eb048ee9439ac9af9ce653c1ed88f20305c6121e946035c42705b0.js integrity="sha512-j5K6b9YHnSWqCeG+Ox41aEOOug+lOgk+tVloQkWpwifWXjRhIusEjulDmsmvnOZTwe2I8gMFxhIelGA1xCcFsA=="></script><script type=text/javascript src=../../../js/theme.min.js defer></script></div><div class=pjax-assets><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{},search:{distance:100,findAllMatches:!0,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:3,noResultsFound:"No results found",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!0},sharerjs:!0}</script><script type=text/javascript src=../../../lib/clipboard/clipboard.min.b08a94127467df50609e03e61edd897a7ce57830ec5f060efa2caf438e8cc3a44bfae7405198f69ffbbf3c663cd0dc51c729ceed1f71206c792c4cf0e0835625.js integrity="sha512-sIqUEnRn31BgngPmHt2JenzleDDsXwYO+iyvQ46Mw6RL+udAUZj2n/u/PGY80NxRxynO7R9xIGx5LEzw4INWJQ=="></script><script type=text/javascript src=../../../lib/sharer/sharer.min.cab91d53e60c836a90e16a5091059006925296eeed2c665fc744b7e7755ec3ab5c4e58e3c83899af70d8f690e004c2ca62062e11b0c7efdced87f80d074cfa3e.js integrity="sha512-yrkdU+YMg2qQ4WpQkQWQBpJSlu7tLGZfx0S353Vew6tcTljjyDiZr3DY9pDgBMLKYgYuEbDH79zth/gNB0z6Pg=="></script></div></body></html>