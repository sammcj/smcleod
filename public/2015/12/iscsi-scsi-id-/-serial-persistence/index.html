<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>iSCSI SCSI-ID / Serial Persistence - smcleod.net</title><meta name=Description content><meta property="og:title" content="iSCSI SCSI-ID / Serial Persistence"><meta property="og:description" content="&ldquo;Having a SCSI ID is a f*cking idiotic thing to do.&rdquo;
- Linus Torvalds
&mldr;and after the amount of time I&rsquo;ve wasted getting XenServer to play nicely with LIO iSCSI failover I tend to agree.
The Problem One oddity of Xen / XenServer&rsquo;s storage subsystem is that it identifies iSCSI storage repositories via a calculated SCSI ID rather than the iSCSI Serial - which would be the sane thing to do.
Citrix&rsquo;s less than ideal take on dealing with SCSI ID changes is for you to take your VMs offline, disconnected the storage repositories, recreate them, then go through all your VMs and re-attach their orphaned disks hoping that you remembered to add some sort of hint as to what VM they belong to, then finally wipe the sweat and tears from your face."><meta property="og:type" content="article"><meta property="og:url" content="https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/"><meta property="og:image" content="https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/feature-san-fran.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-12-14T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-31T15:04:28+11:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/feature-san-fran.jpg"><meta name=twitter:title content="iSCSI SCSI-ID / Serial Persistence"><meta name=twitter:description content="&ldquo;Having a SCSI ID is a f*cking idiotic thing to do.&rdquo;
- Linus Torvalds
&mldr;and after the amount of time I&rsquo;ve wasted getting XenServer to play nicely with LIO iSCSI failover I tend to agree.
The Problem One oddity of Xen / XenServer&rsquo;s storage subsystem is that it identifies iSCSI storage repositories via a calculated SCSI ID rather than the iSCSI Serial - which would be the sane thing to do.
Citrix&rsquo;s less than ideal take on dealing with SCSI ID changes is for you to take your VMs offline, disconnected the storage repositories, recreate them, then go through all your VMs and re-attach their orphaned disks hoping that you remembered to add some sort of hint as to what VM they belong to, then finally wipe the sweat and tears from your face."><meta name=application-name content="smcleod.net"><meta name=apple-mobile-web-app-title content="smcleod.net"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=../../../../logo.svg><link rel=apple-touch-icon sizes=180x180 href=../../../../apple-touch-icon.png><link rel=mask-icon href=../../../../safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/><link rel=prev href=https://beta.smcleod.net/2015/11/how-to-cluster-and-failover-almost-anything-an-intro-to-pacemaker-and-corosync/><link rel=next href=https://beta.smcleod.net/2016/01/fix-xenserver-sr-with-corrupt-or-invalid-metadata/><link rel=stylesheet href=../../../../lib/normalize/normalize.min.8235a67a2521ef99fb1e455a5891b022af1653b4ede3cfffcac4e473beee88fbcc1a36bbb3cfdd75fd6df46732032f9d96e30adae9c88b769e1fbf7945cd27e0.css integrity="sha512-gjWmeiUh75n7HkVaWJGwIq8WU7Tt48//ysTkc77uiPvMGja7s8/ddf1t9GcyAy+dluMK2unIi3aeH795Rc0n4A=="><link rel=stylesheet href=../../../../css/style.min.18108d84e024a889c14d785ff688fe13b654fa9bdc1118490c01fd2d42d6d7ae133fc32040282141aa703a4581fc715573ddde9fdb5f6520fbace1c06f846cd0.css integrity="sha512-GBCNhOAkqInBTXhf9oj+E7ZU+pvcERhJDAH9LULW164TP8MgQCghQapwOkWB/HFVc93en9tfZSD7rOHAb4Rs0A=="><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=../../../../lib/fontawesome-free/all.min.eb8387c9eb0ab6d4fa4d7ad397d15df13b92c009a1eb221b757dd1ecfccabc78a4c5b681847a7f4198ff7cd60abed8300508c9dea138cd1f4a85f09f09b2092a.css integrity="sha512-64OHyesKttT6TXrTl9Fd8TuSwAmh6yIbdX3R7PzKvHikxbaBhHp/QZj/fNYKvtgwBQjJ3qE4zR9KhfCfCbIJKg=="><noscript><link rel=stylesheet href=../../../../lib/fontawesome-free/all.min.eb8387c9eb0ab6d4fa4d7ad397d15df13b92c009a1eb221b757dd1ecfccabc78a4c5b681847a7f4198ff7cd60abed8300508c9dea138cd1f4a85f09f09b2092a.css integrity="sha512-64OHyesKttT6TXrTl9Fd8TuSwAmh6yIbdX3R7PzKvHikxbaBhHp/QZj/fNYKvtgwBQjJ3qE4zR9KhfCfCbIJKg=="></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=../../../../lib/animate/animate.min.738daa4d2c3fc0f677ff92c1cc3f81c397fb6d2176a31a2eeb011bf88fe5a9e68a57914321f32fbd1a7bef6cb88dc24b2ae1943a96c931d83f053979d1f25803.css integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw=="><noscript><link rel=stylesheet href=../../../../lib/animate/animate.min.738daa4d2c3fc0f677ff92c1cc3f81c397fb6d2176a31a2eeb011bf88fe5a9e68a57914321f32fbd1a7bef6cb88dc24b2ae1943a96c931d83f053979d1f25803.css integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw=="></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"iSCSI SCSI-ID / Serial Persistence","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/beta.smcleod.net\/2015\/12\/iscsi-scsi-id-\/-serial-persistence\/"},"image":["https:\/\/beta.smcleod.net\/apple-touch-icon.png"],"genre":"posts","keywords":"tech, storage","wordcount":625,"url":"https:\/\/beta.smcleod.net\/2015\/12\/iscsi-scsi-id-\/-serial-persistence\/","datePublished":"2015-12-14T00:00:00+00:00","dateModified":"2022-10-31T15:04:28+11:00","license":"Sam McLeod","publisher":{"@type":"Organization","name":"Sam McLeod"},"author":{"@type":"Person","name":"Sam McLeod"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark")}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=../../../../ title=smcleod.net><img class="lazyload logo" data-src=../../../../logo.svg data-srcset="../../../../logo.svg, ../../../../logo.svg 1.5x, ../../../../logo.svg 2x" data-sizes=auto alt=/logo.svg title=/logo.svg>smcleod.net</a></div><div class=menu><div class=menu-inner><a class=menu-item href=../../../../posts/>📝 Posts </a><a class=menu-item href=../../../../categories/>🍱 Categories </a><a class=menu-item href=../../../../series/>📚 Series </a><a class=menu-item href=../../../../links/ title="Links to software and services I use">🔗 Links </a><a class=menu-item href=../../../../about/ title="Sam McLeod">🤦🏻‍♂️ About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=# onclick=return!1 class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=../../../../ title=smcleod.net><img class="lazyload logo" data-src=../../../../logo.svg data-srcset="../../../../logo.svg, ../../../../logo.svg 1.5x, ../../../../logo.svg 2x" data-sizes=auto alt=/logo.svg title=/logo.svg>smcleod.net</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=# onclick=return!1 class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=../../../../posts/ title>📝 Posts</a><a class=menu-item href=../../../../categories/ title>🍱 Categories</a><a class=menu-item href=../../../../series/ title>📚 Series</a><a class=menu-item href=../../../../links/ title="Links to software and services I use">🔗 Links</a><a class=menu-item href=../../../../about/ title="Sam McLeod">🤦🏻‍♂️ About</a><a href=# onclick=return!1 class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#the-problem>The Problem</a></li><li><a href=#the-solution>The Solution</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">iSCSI SCSI-ID / Serial Persistence</h1><div class=post-meta><div class=post-meta-line><span class=post-author><i class="author fas fa-user-circle fa-fw"></i><a href=https://github.com/sammcj title=Author target=_blank rel="noopener noreferrer author" class=author>Sam McLeod</a>
</span>&nbsp;<span class=post-category>included in </span>&nbsp;<span class=post-category>category <a href=../../../../categories/tech/><i class="far fa-folder fa-fw"></i>Tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2015-12-14>2015-12-14</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2022-10-31>2022-10-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;625 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#the-problem>The Problem</a></li><li><a href=#the-solution>The Solution</a></li></ul></nav></div></div><div class=content id=content><p><em><strong>&ldquo;Having a SCSI ID is a f*cking idiotic thing to do.&rdquo;</strong></em></p><p><a href=http://yarchive.net/comp/linux/scsi_ids.html target=_blank rel="noopener noreferrer">- Linus Torvalds</a></p><p><em>&mldr;and after the amount of time I&rsquo;ve wasted getting XenServer to play nicely with LIO iSCSI failover I tend to agree.</em></p><hr><h2 id=the-problem class=headerLink><a href=#the-problem class=header-mark></a>The Problem</h2><p><a class=lightgallery href=https://beta.smcleod.net//img/san/sr_fail.jpg title=https://beta.smcleod.net//img/san/sr_fail.jpg data-thumbnail=https://beta.smcleod.net//img/san/sr_fail.jpg><img class=lazyload data-src=https://beta.smcleod.net//img/san/sr_fail.jpg data-srcset="https://beta.smcleod.net//img/san/sr_fail.jpg, https://beta.smcleod.net//img/san/sr_fail.jpg 1.5x, https://beta.smcleod.net//img/san/sr_fail.jpg 2x" data-sizes=auto alt=https://beta.smcleod.net//img/san/sr_fail.jpg></a></p><p>One oddity of Xen / XenServer&rsquo;s storage subsystem is that it identifies iSCSI storage repositories via a calculated SCSI ID rather than the iSCSI Serial - which would be the sane thing to do.</p><p>Citrix&rsquo;s less than ideal take on dealing with SCSI ID changes is for you to take your VMs offline, disconnected the storage repositories, recreate them, then go through all your VMs and re-attach their orphaned disks hoping that you remembered to add some sort of hint as to what VM they belong to, then finally wipe the sweat and tears from your face.</p><p>From <a href=https://support.citrix.com/article/CTX118641 target=_blank rel="noopener noreferrer">CTX11641</a> - &lsquo;How to Identify If SCSI Storage Repository has Changed SCSI IDs&rsquo;:</p><blockquote><p>&ldquo;The SCSI ID of the logical unit number (LUN) changed. When this happened, the iSCSI storage repository became unplugged after a XenServer reboot.&rdquo;
&mldr;
&ldquo;To correct the issue you must recreate a PBD with the entry to reflect the right SCSI ID.&rdquo;</p></blockquote><h2 id=the-solution class=headerLink><a href=#the-solution class=header-mark></a>The Solution</h2><p>A big thank you to Nicholas A. Bellinger from the Kernel SCSI mailing list who helped me a lot in <a href=http://comments.gmane.org/gmane.linux.scsi.target.devel/10617 target=_blank rel="noopener noreferrer">this thread</a> where he explained:</p><blockquote><p>&ldquo;The Company ID, VSI, and VSIE are generated by LIO based upon the current <code>vpd_unit_serial</code> configfs attribute value. So as long as <code>vpd_unit_serial</code> is persistent, and the same value for backend devices across export failover to different nodes, Xen will always see the same EVPD information.&rdquo;</p><p>An example SCSI ID of <code>0x6001405bff3f42a49d84cfcb64e2b933</code> would thus be comprised of:</p><ul><li>NAA 6, IEEE Company_id: <code>0x1405</code></li><li>Vendor Specific Identifier: <code>0xbff3f42a4</code></li><li>Vendor Specific Identifier Extension: <code>0x9d84cfcb64e2b933</code></li></ul></blockquote><p>In addition to the <code>vpd_unit_serial</code> we found that the <code>iblock</code> number must also remain the same between failovers.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>/sys/kernel/config/target/core/iblock_0/lun_name/wwn/vpd_unit_serial
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/sys/kernel/config/target/core # tree
</span></span><span class=line><span class=cl>├── iblock_0                            # Must be consistent between failovers
</span></span><span class=line><span class=cl>│   └── iscsi_lun_r2
</span></span><span class=line><span class=cl>│      └── wwn
</span></span><span class=line><span class=cl>│         └── vpd_unit_serial           # Must be consistent between failovers
</span></span></code></pre></div><p>If you&rsquo;re using Corosync / Pacemaker for your target failover the <code>vpd_unit_serial</code> and <code>iblock</code> number must both be set in the <code>iSCSILogicalUnit</code> OCF provider:</p><ul><li>The <code>iblock</code> number is configured with <code>lio_iblock=&lt;number></code> - <a href=https://github.com/ClusterLabs/resource-agents/blob/master/heartbeat/iSCSILogicalUnit#L217 target=_blank rel="noopener noreferrer">See iSCSILogicalUnit#L217</a></li><li>The <code>vpd_unit_serial</code> is configured with <code>scsi_sn=&lt;number></code> - <a href=https://github.com/ClusterLabs/resource-agents/blob/master/heartbeat/iSCSILogicalUnit#L138 target=_blank rel="noopener noreferrer">See iSCSILogicalUnit#L138</a></li></ul><p>Here is an example of a target and lun configured with <code>pcs</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Resource: iscsi_target_r2 (class=ocf provider=heartbeat type=iSCSITarget)
</span></span><span class=line><span class=cl>Attributes: iqn=iqn.2003-01.org.linux-iscsi.pm-san.x8664:sn.ca7d7b33c731 portals=10.50.42.75:3260 implementation=lio-t additional_parameters=&#34;MaxConnections=100 AuthMethod=None InitialR2T=No MaxOutstandingR2T=64&#34;
</span></span><span class=line><span class=cl>Operations: monitor on-fail=restart interval=30s timeout=20s (iscsi_target_r2-monitor-30s)
</span></span><span class=line><span class=cl>            start on-fail=restart interval=0 timeout=20s (iscsi_target_r2-start-0)
</span></span><span class=line><span class=cl>            stop on-fail=restart interval=0 timeout=20s (iscsi_target_r2-stop-0)
</span></span><span class=line><span class=cl>Resource: iscsi_lun_r2 (class=ocf provider=heartbeat type=iSCSILogicalUnit)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Attributes: target_iqn=iqn.2003-01.org.linux-iscsi.pm-san.x8664:sn.ca7d7b33c731 scsi_sn=633c5643 lun=1 lio_iblock=2 path=/dev/drbd2 allowed_initiators=&#34;iqn.2015-05.com.example:51e1fb93&#34; implementation=lio-t
</span></span><span class=line><span class=cl>Operations: monitor on-fail=restart interval=30s timeout=10s (iscsi_lun_r2-monitor-30s)
</span></span><span class=line><span class=cl>            start on-fail=restart interval=0 timeout=20s (iscsi_lun_r2-start-0)
</span></span><span class=line><span class=cl>            stop on-fail=restart interval=0 timeout=20s (iscsi_lun_r2-stop-0)
</span></span><span class=line><span class=cl>Resource: iscsi_conf_r2 (class=ocf provider=heartbeat type=anything)
</span></span><span class=line><span class=cl>Attributes: binfile=/usr/sbin/iscsi_iscsi_conf_r2.sh stop_timeout=3
</span></span></code></pre></div><p>If you happen to be using Puppet for your Pacemaker configuration it might look a bit like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>  cs_primitive { &#34;$iscsi_target_primitive&#34;:
</span></span><span class=line><span class=cl>    primitive_class =&gt; &#39;ocf&#39;,
</span></span><span class=line><span class=cl>    primitive_type  =&gt; &#39;iSCSITarget&#39;,
</span></span><span class=line><span class=cl>    provided_by     =&gt; &#39;heartbeat&#39;,
</span></span><span class=line><span class=cl>    parameters      =&gt; {  &#39;iqn&#39;                   =&gt; &#34;$iscsi_iqn&#34;,
</span></span><span class=line><span class=cl>                          &#39;portals&#39;               =&gt; &#34;${iscsi_vip}:3260&#34;,
</span></span><span class=line><span class=cl>                          &#39;implementation&#39;        =&gt; &#39;lio-t&#39;,
</span></span><span class=line><span class=cl>                          &#39;additional_parameters&#39; =&gt; &#39;MaxConnections=100 AuthMethod=None InitialR2T=No MaxOutstandingR2T=64&#39;,
</span></span><span class=line><span class=cl>                        },
</span></span><span class=line><span class=cl>    operations      =&gt;  {  &#39;monitor&#39;              =&gt; { &#39;timeout&#39; =&gt; &#39;20s&#39;, &#39;interval&#39; =&gt; &#39;30s&#39;,&#39;on-fail&#39; =&gt; &#34;restart&#34;},
</span></span><span class=line><span class=cl>                           &#39;start&#39;                =&gt; { &#39;timeout&#39; =&gt; &#39;20s&#39;, &#39;interval&#39; =&gt; &#39;0&#39;,&#39;on-fail&#39;   =&gt; &#34;restart&#34;},
</span></span><span class=line><span class=cl>                           &#39;stop&#39;                 =&gt; { &#39;timeout&#39; =&gt; &#39;20s&#39;, &#39;interval&#39; =&gt; &#39;0&#39;,&#39;on-fail&#39;   =&gt; &#34;restart&#34;},
</span></span><span class=line><span class=cl>                        },
</span></span><span class=line><span class=cl>    require         =&gt; [Cs_primitive[&#34;$ip_primitive&#34;],Package[&#39;targetcli&#39;],Service[&#39;pacemaker&#39;]],
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  cs_primitive { &#34;$iscsi_lun_primitive&#34;:
</span></span><span class=line><span class=cl>    primitive_class =&gt; &#39;ocf&#39;,
</span></span><span class=line><span class=cl>    primitive_type  =&gt; &#39;iSCSILogicalUnit&#39;,
</span></span><span class=line><span class=cl>    provided_by     =&gt; &#39;heartbeat&#39;,
</span></span><span class=line><span class=cl>    parameters      =&gt; {  &#39;target_iqn&#39;            =&gt; $iscsi_iqn,
</span></span><span class=line><span class=cl>                          &#39;scsi_sn&#39;               =&gt; $scsi_sn,
</span></span><span class=line><span class=cl>                          &#39;lun&#39;                   =&gt; &#39;1&#39;,
</span></span><span class=line><span class=cl>                          &#39;lio_iblock&#39;            =&gt; $lio_iblock,
</span></span><span class=line><span class=cl>                          &#39;path&#39;                  =&gt; $drbd_path,
</span></span><span class=line><span class=cl>                          &#39;allowed_initiators&#39;    =&gt; $allowed_initiators,
</span></span><span class=line><span class=cl>                          &#39;implementation&#39;        =&gt; &#39;lio-t&#39;},
</span></span><span class=line><span class=cl>    operations      =&gt; {  &#39;monitor&#39;               =&gt; { &#39;timeout&#39; =&gt; &#39;10s&#39;, &#39;interval&#39; =&gt; &#39;30s&#39;,&#39;on-fail&#39; =&gt; &#34;restart&#34; },
</span></span><span class=line><span class=cl>                          &#39;start&#39;                 =&gt; { &#39;timeout&#39; =&gt; &#39;20s&#39;, &#39;interval&#39; =&gt; &#39;0&#39;  ,&#39;on-fail&#39; =&gt; &#34;restart&#34; },
</span></span><span class=line><span class=cl>                          &#39;stop&#39;                  =&gt; { &#39;timeout&#39; =&gt; &#39;20s&#39;, &#39;interval&#39; =&gt; &#39;0&#39;  ,&#39;on-fail&#39; =&gt; &#34;restart&#34; },
</span></span><span class=line><span class=cl>                        },
</span></span><span class=line><span class=cl>    require         =&gt; [Cs_primitive[&#34;$iscsi_target_primitive&#34;],Service[&#39;pacemaker&#39;]],
</span></span><span class=line><span class=cl>  }
</span></span></code></pre></div></div><h2>Related Content</h2><div class=related-container><div class=related-item-container><div class=related-image><a href=../../../../2022/10/making-work-visible-avoid-dms/><img class=lazyload data-src=../../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg data-srcset="../../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg, ../../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg 1.5x, ../../../../2022/10/making-work-visible-avoid-dms/dm-disruption.jpg 2x" data-sizes=auto alt=/2022/10/making-work-visible-avoid-dms/dm-disruption.jpg title=/2022/10/making-work-visible-avoid-dms/dm-disruption.jpg height=200 width=400></a></div><h2 class=related-title><a href=../../../../2022/10/making-work-visible-avoid-dms/>Making Work Visible - Avoid DMs</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../../2019/08/camels-dressed-as-unicorns/><img class=lazyload data-src=../../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg data-srcset="../../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg, ../../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg 1.5x, ../../../../2019/08/camels-dressed-as-unicorns/camel_corn.jpeg 2x" data-sizes=auto alt=/2019/08/camels-dressed-as-unicorns/camel_corn.jpeg title=/2019/08/camels-dressed-as-unicorns/camel_corn.jpeg height=200 width=400></a></div><h2 class=related-title><a href=../../../../2019/08/camels-dressed-as-unicorns/>Camels Dressed As Unicorns</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../../2019/08/looking-for-new-opportunities/><img class=lazyload data-src=../../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg data-srcset="../../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg, ../../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg 1.5x, ../../../../2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg 2x" data-sizes=auto alt=/2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg title=/2019/08/looking-for-new-opportunities/fiji_aws_prac_training_1.jpg height=200 width=400></a></div><h2 class=related-title><a href=../../../../2019/08/looking-for-new-opportunities/>Looking For New Opportunities</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../../2019/06/leaving-infoxchange/><img class=lazyload data-src=../../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg data-srcset="../../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg, ../../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg 1.5x, ../../../../2019/06/leaving-infoxchange/road-no-car-2048.jpg 2x" data-sizes=auto alt=/2019/06/leaving-infoxchange/road-no-car-2048.jpg title=/2019/06/leaving-infoxchange/road-no-car-2048.jpg height=200 width=400></a></div><h2 class=related-title><a href=../../../../2019/06/leaving-infoxchange/>Leaving Infoxchange</a></h2></div><div class=related-item-container><div class=related-image><a href=../../../../2019/02/goodbye-xensever-hello-xcp-ng/><img class=lazyload data-src=../../../../2019/02/goodbye-xensever-hello-xcp-ng/xcpng_rocket_logo.png data-srcset="../../../../2019/02/goodbye-xensever-hello-xcp-ng/xcpng_rocket_logo.png, ../../../../2019/02/goodbye-xensever-hello-xcp-ng/xcpng_rocket_logo.png 1.5x, ../../../../2019/02/goodbye-xensever-hello-xcp-ng/xcpng_rocket_logo.png 2x" data-sizes=auto alt=/2019/02/goodbye-xensever-hello-xcp-ng/xcpng_rocket_logo.png title=/2019/02/goodbye-xensever-hello-xcp-ng/xcpng_rocket_logo.png height=200 width=400></a></div><h2 class=related-title><a href=../../../../2019/02/goodbye-xensever-hello-xcp-ng/>Goodbye XenSever - Hello XCP-ng</a></h2></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-10-31&nbsp;<a class=git-hash href=https://github.com/sammcj/smcleod-hugo/commit/28c2c547888f2ba4282f805d20e3bc774697430d target=_blank title="commit by Sam McLeod(sammcj@users.noreply.github.com) 28c2c547888f2ba4282f805d20e3bc774697430d: A new start" rel="noopener noreferrer">
<i class="fas fa-hashtag fa-fw"></i>28c2c54</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-mardown href=../../../../2015/12/iscsi-scsi-id-/-serial-persistence/index.md target=_blank rel="noopener noreferrer">Read markdown</a>
</span><span>|&nbsp;<a class=link-to-edit href=https://github.com/sammcj/smcleod-hugo/edit/main/content/posts/2015-12-14-iscsi-scsiid-persistence/index.md target=_blank rel="noopener noreferrer">Edit this page</a></span></div><div class=post-info-share><span><a href=# onclick=return!1 title="Share on Twitter" data-sharer=twitter data-url=https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/ data-title="iSCSI SCSI-ID / Serial Persistence" data-via=s_mcleod data-hashtags=tech,storage><i class="fab fa-twitter fa-fw"></i></a><a href=# onclick=return!1 title="Share on Linkedin" data-sharer=linkedin data-url=https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/><i class="fab fa-linkedin fa-fw"></i></a><a href=# onclick=return!1 title="Share on Hacker News" data-sharer=hackernews data-url=https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/ data-title="iSCSI SCSI-ID / Serial Persistence"><i class="fab fa-hacker-news fa-fw"></i></a><a href=# onclick=return!1 title="Share on Reddit" data-sharer=reddit data-url=https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/><i class="fab fa-reddit fa-fw"></i></a><a href=# onclick=return!1 title="Share on Pocket" data-sharer=pocket data-url=https://beta.smcleod.net/2015/12/iscsi-scsi-id-/-serial-persistence/><i class="fab fa-get-pocket fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=../../../../tags/tech/>tech</a>,&nbsp;<a href=../../../../tags/storage/>storage</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=../../../../>Home</a></span></section></div><div class=post-nav><a href=../../../../2015/11/how-to-cluster-and-failover-almost-anything-an-intro-to-pacemaker-and-corosync/ class=prev rel=prev title="How to cluster and failover (almost) anything - An intro to Pacemaker and Corosync"><i class="fas fa-angle-left fa-fw"></i>How to cluster and failover (almost) anything - An intro to Pacemaker and Corosync</a>
<a href=../../../../2016/01/fix-xenserver-sr-with-corrupt-or-invalid-metadata/ class=next rel=next title="Fix XenServer SR with corrupt or invalid metadata">Fix XenServer SR with corrupt or invalid metadata<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2010 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/sammcj target=_blank rel="noopener noreferrer">Sam McLeod</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=../../../../atkinson-hyperlegible/atkinson-hyperlegible.eab28ad9966784d2ce9271970fa9cde34de4a323c0e4cd22fb5ffbf5261b049f52e236f1c06684c0ba73f72454f180c6e9e4667bee6cec7e9d5ac2d9dcb7b24e.css integrity="sha512-6rKK2ZZnhNLOknGXD6nN403koyPA5M0i+1/79SYbBJ9S4jbxwGaEwLpz9yRU8YDG6eRme+5s7H6dWsLZ3LeyTg=="><noscript><link rel=stylesheet href=../../../../atkinson-hyperlegible/atkinson-hyperlegible.eab28ad9966784d2ce9271970fa9cde34de4a323c0e4cd22fb5ffbf5261b049f52e236f1c06684c0ba73f72454f180c6e9e4667bee6cec7e9d5ac2d9dcb7b24e.css integrity="sha512-6rKK2ZZnhNLOknGXD6nN403koyPA5M0i+1/79SYbBJ9S4jbxwGaEwLpz9yRU8YDG6eRme+5s7H6dWsLZ3LeyTg=="></noscript><script type=text/javascript src=../../../../lib/autocomplete/autocomplete.min.0dcc8ee301dccbd9fb18115a1176e1293ca233b99aee5f5d12f218463c34eccea29f842827fc1ce330cf26e1e21b1382725ad3d0703cbde9f7e28552bcd92c07.js integrity="sha512-DcyO4wHcy9n7GBFaEXbhKTyiM7ma7l9dEvIYRjw07M6in4QoJ/wc4zDPJuHiGxOCclrT0HA8ven34oVSvNksBw=="></script><script type=text/javascript src=../../../../lib/fuse/fuse.min.3dd1499ec34f39e57a4363bb184754a5023e0f9c47115d67dbec47058d78fb562f0c929c84d44a0a1ca7f84ed73b907e40fa84995338a66677721853139fb70f.js integrity="sha512-PdFJnsNPOeV6Q2O7GEdUpQI+D5xHEV1n2+xHBY14+1YvDJKchNRKChyn+E7XO5B+QPqEmVM4pmZ3chhTE5+3Dw=="></script><script type=text/javascript src=../../../../lib/lazysizes/lazysizes.min.ab9f37a692ab09173b3793b49f69f352227eb2e52fec4b752467a5b386d739a30541c6a63e4f478dd5249d9bae16304db3bb6c32e69d81ee64f51cdd98efb519.js integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ=="></script><script type=text/javascript src=../../../../lib/topbar/topbar.min.db5613fde0d014e29123106077225a764bdb4bdf791c2d252c1db5c09f19ea0bd181d29e10a1c03fddc6b0666d83ed17645ee84c31fb405fc7c0b8b38fd95eb0.js integrity="sha512-21YT/eDQFOKRIxBgdyJadkvbS995HC0lLB21wJ8Z6gvRgdKeEKHAP93GsGZtg+0XZF7oTDH7QF/HwLizj9lesA=="></script><script type=text/javascript src=../../../../lib/pjax/pjax.min.8f92ba6fd6079d25aa09e1be3b1e3568438eba0fa53a093eb559684245a9c227d65e346122eb048ee9439ac9af9ce653c1ed88f20305c6121e946035c42705b0.js integrity="sha512-j5K6b9YHnSWqCeG+Ox41aEOOug+lOgk+tVloQkWpwifWXjRhIusEjulDmsmvnOZTwe2I8gMFxhIelGA1xCcFsA=="></script><script type=text/javascript src=../../../../js/theme.min.js defer></script></div><div class=pjax-assets><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{},search:{distance:100,findAllMatches:!0,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:3,noResultsFound:"No results found",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!0},sharerjs:!0}</script><script type=text/javascript src=../../../../lib/clipboard/clipboard.min.b08a94127467df50609e03e61edd897a7ce57830ec5f060efa2caf438e8cc3a44bfae7405198f69ffbbf3c663cd0dc51c729ceed1f71206c792c4cf0e0835625.js integrity="sha512-sIqUEnRn31BgngPmHt2JenzleDDsXwYO+iyvQ46Mw6RL+udAUZj2n/u/PGY80NxRxynO7R9xIGx5LEzw4INWJQ=="></script><script type=text/javascript src=../../../../lib/sharer/sharer.min.cab91d53e60c836a90e16a5091059006925296eeed2c665fc744b7e7755ec3ab5c4e58e3c83899af70d8f690e004c2ca62062e11b0c7efdced87f80d074cfa3e.js integrity="sha512-yrkdU+YMg2qQ4WpQkQWQBpJSlu7tLGZfx0S353Vew6tcTljjyDiZr3DY9pDgBMLKYgYuEbDH79zth/gNB0z6Pg=="></script></div></body></html>