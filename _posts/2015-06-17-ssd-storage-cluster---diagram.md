---
title: SSD Storage Cluster - Update and Diagram
categories: []
date: 2015-06-17
---

Unfortunately due to several recent family events I am behind on the projectm hence the lack of updates which I appologise for.
However, the goods news is that I'm back working to finish off the clusters and I'm happy to report that all is going well!

Here is the final digram of the two-node cluster design:

![]({{ site.url }}/images/san/diagram.png){: .center-image }

and in plain text / src:
{% highlight bash %}
   ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓                       ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
   ┃                                             ┌─────┐┌─────┐    ┌─────┐┌─────┐┃                       ┃                                             ┌─────┐┌─────┐    ┌─────┐┌─────┐┃
   ┃                                             │SATA ││SATA │    │SATA ││SATA │┃                       ┃                                             │SATA ││SATA │    │SATA ││SATA │┃
   ┃ ┌─────────────────┐  ┌─────────────────┐    │ SSD ││ SSD │    │ SSD ││ SSD │┃                       ┃ ┌─────────────────┐  ┌─────────────────┐    │ SSD ││ SSD │    │ SSD ││ SSD │┃
   ┃ │  PCIe NVMe SSD  │  │  PCIe NVMe SSD  │    └─────┘└─────┘    └─────┘└─────┘┃                       ┃ │  PCIe NVMe SSD  │  │  PCIe NVMe SSD  │    └─────┘└─────┘    └─────┘└─────┘┃
   ┃ │                 │  │                 │    ┌─────┐┌─────┐    ┌─────┐┌─────┐┃                       ┃ │                 │  │                 │    ┌─────┐┌─────┐    ┌─────┐┌─────┐┃
   ┃ └─────────────────┘  └─────────────────┘    │SATA ││SATA │    │SATA ││SATA │┃                       ┃ └─────────────────┘  └─────────────────┘    │SATA ││SATA │    │SATA ││SATA │┃
   ┃                                             │ SSD ││ SSD │    │ SSD ││ SSD │┃                       ┃                                             │ SSD ││ SSD │    │ SSD ││ SSD │┃
   ┃                                             └─────┘└─────┘    └─────┘└─────┘┃                       ┃                                             └─────┘└─────┘    └─────┘└─────┘┃
   ┃                                             ┌────────────┐    ┌────────────┐┃                       ┃                                             ┌────────────┐    ┌────────────┐┃
   ┃ ┌──────────────────────────────────────┐    │ MDADM RAID │    │ MDADM RAID │┃                       ┃ ┌──────────────────────────────────────┐    │ MDADM RAID │    │ MDADM RAID │┃
   ┃ │             MDADM RAID 1             │    │    1+0     │    │    1+0     │┃                       ┃ │             MDADM RAID 1             │    │    1+0     │    │    1+0     │┃
   ┃ └──────────────────────────────────────┘    └────────────┘    └────────────┘┃                       ┃ └──────────────────────────────────────┘    └────────────┘    └────────────┘┃
   ┃ ┌──────────────────────────────────────┐    ┌──────────────────────────────┐┃                       ┃ ┌──────────────────────────────────────┐    ┌──────────────────────────────┐┃
   ┃ │                 LVM                  │    │             LVM              │┃                       ┃ │                 LVM                  │    │             LVM              │┃
   ┃ └──────────────────────────────────────┘    └──────────────────────────────┘┃                       ┃ └──────────────────────────────────────┘    └──────────────────────────────┘┃
   ┃                                                                             ┃                       ┃                                                                             ┃
   ┃          ┌────────┐┌────────┐                    ┌────────┐┌────────┐       ┃                       ┃          ┌────────┐┌────────┐                     ┌────────┐┌────────┐      ┃
   ┃          │  DRBD  ││  DRBD  │                    │  DRBD  ││  DRBD  │       ┃                       ┃          │  DRBD  ││  DRBD  │                     │  DRBD  ││  DRBD  │      ┃
   ┃          └────────┘└────────┘                    └────────┘└────────┘       ┃                       ┃          └────────┘└────────┘                     └────────┘└────────┘      ┃
   ┃               ▲         │                             ▲         │           ┃                       ┃               ▲         │                              ▲         │          ┃
   ┃               │                                                             ┃                       ┃                                                        │                    ┃
   ┃                         │                             │         │           ┃                       ┃               │         │                                        │          ┃
   ┃               │                                                  ─ ─ ─ ─ ─ ─┣───────────────────────┫─ ─ ─ ─ ─ ─ ─ ─                                         │                    ┃
   ┃                         │                             └ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┤  2x 10GbE CAT6 Bond   ├ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┘                                        │          ┃
   ┃               │                                                             │   (Active/Passive)    │                                                        │                    ┃
   ┃                         └ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┤                       ├ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─          │          ┃
   ┃               └ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ╋───────────────────────╋ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─           ┃
   ┃                                                                             ┃                       ┃                                                                             ┃
   ┃   ┌──────────────────────┬──────────────────────┬──────────────────────┐    ┃                       ┃   ┌──────────────────────┬──────────────────────┬──────────────────────┐    ┃
   ┃   │     iSCSI Target     │     iSCSI Target     │     iSCSI Target     │    ┃                       ┃   │     iSCSI Target     │     iSCSI Target     │     iSCSI Target     │    ┃
   ┃   │     (Per LUN IP)     │     (Per LUN IP)     │     (Per LUN IP)     │    ┃                       ┃   │     (Per LUN IP)     │     (Per LUN IP)     │     (Per LUN IP)     │    ┃
   ┃   └──────────────────────┴──────────────────────┴──────────────────────┘    ┃                       ┃   └──────────────────────┴──────────────────────┴──────────────────────┘    ┃
   ┃                                                                             ┃                       ┃                                                                             ┃
   ┗━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┛                       ┗━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┛
                  10Gb DAC                                10Gb DAC                                                      10Gb DAC                                10Gb DAC
                    LACP                                    LACP                                                          LACP                                    LACP
                  MEMBER 1                                MEMBER 2                                                      MEMBER 1                                MEMBER 2
   ┌──────────────────┴──────────────────┳━┳──────────────────┴──────────────────┐                       ┌──────────────────┴──────────────────┳━┳──────────────────┴──────────────────┐
   │        Switch Cluster Node 1        │ │        Switch Cluster Node 2        │                       │        Switch Cluster Node 1        │ │        Switch Cluster Node 2        │
   └──────────────────┬──────────────────┻━┻──────────────────┬──────────────────┘                       └──────────────────┬──────────────────┻━┻──────────────────┬──────────────────┘
                  10Gb DAC                                10Gb DAC                                                      10Gb DAC                                10Gb DAC
                    LACP                                    LACP                                                          LACP                                    LACP
                  MEMBER 1                                MEMBER 2                                                      MEMBER 1                                MEMBER 2
   ┌──────────────────┴───────────────────────────────────────┼──────────────────┐                       ┌──────────────────┴───────────────────────────────────────┼──────────────────┐
   │  ┌───────────────────────────────────────────────────────┴───────────────┐  │                       │  ┌───────────────────────────────────────────────────────┴───────────────┐  │
   │  │                                                                       │  │                       │  │                                                                       │  │
   │  │                                                                       │  │                       │  │                                                                       │  │
   │  │                                                                       │  │                       │  │                                                                       │  │
   │  │                                                                       │  │                       │  │                                                                       │  │
   │  │                                                                       │  │                       │  │                                                                       │  │
   │  │                                                                       │  │                       │  │                                                                       │  │
   │  │              ┌─────────────────┐     ┌─────────────────┐              │  │                       │  │              ┌─────────────────┐     ┌─────────────────┐              │  │
   │  │              │      iSCSI      │     │      iSCSI      │              │  │                       │  │              │      iSCSI      │     │      iSCSI      │              │  │
   │  │              ├─────────────────┤     ├─────────────────┤              │  │                       │  │              ├─────────────────┤     ├─────────────────┤              │  │
   │  └──────────────┤ Physical Server │     │ Physical Server ├──────────────┘  │                       │  └──────────────┤ Physical Server │     │ Physical Server ├──────────────┘  │
   │                 │                 │     │                 │                 │                       │                 │                 │     │                 │                 │
   └─────────────────┤                 │     │                 ├─────────────────┘                       └─────────────────┤                 │     │                 ├─────────────────┘
                     │                 │     │                 │                                                           │                 │     │                 │
                     ├─────┬─────┬─────┤     ├─────┬─────┬─────┤                                                           ├─────┬─────┬─────┤     ├─────┬─────┬─────┤
                     │ LVM │ LVM │ LVM │     │ LVM │ LVM │ LVM │                                                           │ LVM │ LVM │ LVM │     │ LVM │ LVM │ LVM │
                     ├─────┼─────┼─────┤     ├─────┼─────┼─────┤                                                           ├─────┼─────┼─────┤     ├─────┼─────┼─────┤
                     │     │     │     │     │     │     │     │                                                           │     │     │     │     │     │     │     │
                     │     │     │     │     │     │     │     │                                                           │     │     │     │     │     │     │     │
                     │ VM  │ VM  │ VM  │     │ VM  │ VM  │ VM  │                                                           │ VM  │ VM  │ VM  │     │ VM  │ VM  │ VM  │
                     │     │     │     │     │     │     │     │                                                           │     │     │     │     │     │     │     │
                     │     │     │     │     │     │     │     │                                                           │     │     │     │     │     │     │     │
                     └─────┴─────┴─────┘     └─────┴─────┴─────┘                                                           └─────┴─────┴─────┘     └─────┴─────┴─────┘
{% endhighlight %}

More on this soon...